Use CanaryAirlines;

--EXERCISE 1
SELECT E.LASTNAME, E.FIRSTNAME, A.AIRPORTNAME
FROM Employees E, Airports A
WHERE E.State='IN';

--EXERCISE 2
SELECT E.LASTNAME, E.FIRSTNAME, A.AIRPORTNAME
FROM Employees E, Airports A
WHERE E.AirportID=A.AirportID
AND E.State='IN';

--EXERCISE 3
SELECT E.LASTNAME, E.FIRSTNAME, A.AIRPORTNAME
FROM Employees E INNER JOIN Airports A
ON E.AirportID=A.AirportID
WHERE E.State='IN';

--EXERCISE 4
SELECT	A.AIRPORTNAME, A.CITY,
		F.FlightID, F.FLIGHTDURATION, DATENAME(MONTH, F.FLIGHTSTART) AS F_MONTH, DATENAME(YEAR, F.FLIGHTSTART) AS F_YEAR
FROM    Airports A, Flights F, Routes R
WHERE   F.RouteID=R.RouteID
AND	    A.AirportID=R.SourceAirportID
AND     DATENAME(MONTH, F.FLIGHTSTART) ='MAY'
AND	    DATENAME(YEAR, F.FLIGHTSTART)  ='2013';

--EXERCISE 4, ANOTHER SOLUTION
SELECT	A.AIRPORTNAME, A.CITY,
		F.FlightID, F.FLIGHTDURATION, F.FLIGHTSTART
FROM    Routes R 
				INNER JOIN Airports A ON A.AirportID=R.SourceAirportID 
				INNER JOIN FLIGHTS F ON F.RouteID=R.RouteID
WHERE   MONTH(F.FLIGHTSTART)=5
AND	    YEAR(F.FLIGHTSTART)=2013;


--TESTING

SELECT * FROM Flights
WHERE MONTH(FLIGHTS.FLIGHTSTART)=5
AND YEAR(FLIGHTS.FLIGHTSTART)=2013;

SELECT FlightStart = DATENAME(MONTH, FlightStart) FROM FLIGHTS;
